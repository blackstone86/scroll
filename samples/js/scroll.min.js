var ScrollEmulate=function(t){var s=this,t="#"+t+" ";s.wrap=nmg(t);s.cnt=nmg(t+".j_cntbox");s.scrollbar=nmg(t+".j_bar");s.scrollbtn=nmg(t+".j_point");s.scrollbtnOffsetLimit=[];s.cntOffsetLimit=[];s.pointX=0;s.pointY=0;s.cntCurrOffset=0;s.scrollbtnCurrOffset=0;s.isVariableContent=true;s.cntHeight=s.cnt.height().toNum();setTimeout(function(){s.work();if(s.isVariableContent){s.initWhenContentChange()}},350)};ScrollEmulate.prototype={has3d:"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozTransition"in document.createElement("DIV").style,hasTouch:"ontouchstart"in window,setScrollBtnHeight:function(){var t=this,s=t.cnt.height().toNum(),e=t.wrap.css("height").toNum(),n=s>e;if(n){var o=parseInt(Math.pow(e,2)/s,10);t.scrollbtn.css("height",o+"px")}else{t.scrollbar.hide()}},pos:function(t,s){var e=this;if(e.has3d&&!nmg.browser.isFirefox){t.css("translate","0,"+s+"px")}else{t.css("top",s+"px")}},getCurrOffset:function(t){var s=this,e=0;if(s.has3d&&!nmg.browser.isFirefox){var n=t.css("translate");e=parseInt(n.match(/,(.*),/)[1].replace(/\s*/,"").toNum(),10)}else{e=parseInt(t.css("top").toNum(),10)}return e},setScrollBtnPos:function(t){var s=this,e=s.scrollbtnCurrOffset;e+=t;if(e<=s.scrollbtnOffsetLimit[0]){e=s.scrollbtnOffsetLimit[0]}else if(e>=s.scrollbtnOffsetLimit[1]){e=s.scrollbtnOffsetLimit[1]}s.setScrollCntPos_ByScrollBtn(e);s.pos(s.scrollbtn,e)},setScrollCntPos_ByScrollBtn:function(t){var s=this,e=s.cntCurrOffset;e=-(t/s.wrap.height().toNum())*s.cnt.height().toNum();if(e<=s.cntOffsetLimit[0]){e=s.cntOffsetLimit[0]}else if(e>=s.cntOffsetLimit[1]){e=s.cntOffsetLimit[1]}s.pos(s.cnt,e)},setScrollCntPos:function(t){var s=this,e=s.cntCurrOffset;e+=t;if(e<=s.cntOffsetLimit[0]){e=s.cntOffsetLimit[0]}else if(e>=s.cntOffsetLimit[1]){e=s.cntOffsetLimit[1]}s.setScrollBtnPos_ByScrollCnt(e);s.pos(s.cnt,e)},setScrollBtnPos_ByScrollCnt:function(t){var s=this,e=s.scrollbtnCurrOffset;e=-(t*s.wrap.height().toNum())/s.cnt.height().toNum();if(e<=s.scrollbtnOffsetLimit[0]){e=s.scrollbtnOffsetLimit[0]}else if(e>=s.scrollbtnOffsetLimit[1]){e=s.scrollbtnOffsetLimit[1]}s.pos(s.scrollbtn,e)},setPos:function(t){var s=this;if(!s.hasTouch){s.setScrollBtnPos(t)}else{s.setScrollCntPos(t)}},handleEvent:function(t){var s=this;if(!nmg.support.hasTouch){nmg.preventDefault(t)}switch(t.type){case eventFix.mousedown:s.mousedown(t);break;case eventFix.mousemove:s.mousemove(t);break;case eventFix.mouseup:s.mouseup(t);break;case eventFix.mousewheel:s.mousewheel(t);break}},mousedown:function(t){var s=this,t=nmg.support.hasTouch?t.touches[0]:t;s.directionLocked=false;s.pointX=nmg.browser.isIE?t.clientX:t.pageX;s.pointY=nmg.browser.isIE?t.clientY:t.pageY;s.cntCurrOffset=s.getCurrOffset(s.cnt);s.scrollbtnCurrOffset=s.getCurrOffset(s.scrollbtn);nmg(document).bind("mousemove",s);nmg(document).bind("mouseup",s)},mousemove:function(t){var s=this,t=nmg.support.hasTouch?t.touches[0]:t,e=(nmg.browser.isIE?t.clientX:t.pageX)-s.pointX,n=(nmg.browser.isIE?t.clientY:t.pageY)-s.pointY;s.setPos(n)},mouseup:function(){var t=this;nmg(document).unbind("mousemove",t);nmg(document).unbind("mouseup",t)},initOffset:function(t){var s=this,e=isNaN(t)?0:t;if(s.has3d&&!nmg.browser.isFirefox){if(e!=0){s.scrollbtn.css("translate","0, "+e);s.setScrollCntPos_ByScrollBtn(e)}else{s.cnt.css("translate","0, 0");s.scrollbtn.css("translate","0, 0")}}else{if(e!=0){s.scrollbtn.css("top",e);s.setScrollCntPos_ByScrollBtn(e)}else{s.cnt.css("top",0);s.scrollbtn.css("top",0)}}},mousewheel:function(t){var s=this;s.cntCurrOffset=s.getCurrOffset(s.cnt);s.scrollbtnCurrOffset=s.getCurrOffset(s.scrollbtn);if(nmg.isWheelDown(t)){s.setPos(40)}else{s.setPos(-40)}},init:function(t){var s=this;s.setScrollBtnHeight();s.scrollbtnOffsetLimit=[0,s.wrap.height().toNum()-s.scrollbtn.height().toNum()];s.cntOffsetLimit=[s.wrap.height().toNum()-s.cnt.height().toNum(),0];s.initOffset(t)},initWhenContentChange:function(){var t=this;setInterval(function(){var s=t.cnt.height().toNum();if(s!=t.cntHeight){var e=t.getCurrOffset(t.scrollbtn);t.init(e);t.cntHeight=s}},500)},work:function(){var t=this;t.init();if(!t.hasTouch){t.scrollbtn.bind("mousedown",t);t.wrap.bind("mousewheel",t)}else{t.cnt.bind("mousedown",t)}}};